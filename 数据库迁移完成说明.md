# SQLite到MariaDB迁移完成说明

## 迁移完成情况

✅ **已完成的任务：**

### 1. 数据库配置更新
- [x] 更新 `backend/src/app.module.ts` - 从SQLite改为MariaDB配置
- [x] 更新 `backend/.env` 和 `backend/.env.example` - 添加MariaDB连接参数
- [x] 确认 `backend/src/data-source.ts` 已正确配置为MySQL/MariaDB

### 2. 依赖管理
- [x] 检查并确认 `mysql2` 依赖已存在
- [x] 更新 `backend/package.json` 关键词，移除SQLite相关
- [x] 确认无SQLite相关依赖需要移除

### 3. 文档更新
- [x] 更新 `backend/README.md` - 将SQLite改为MariaDB/MySQL
- [x] 更新项目描述和数据库说明

### 4. Docker配置
- [x] 更新根目录 `docker-compose.yml` - 添加MariaDB服务
- [x] 创建 `backend/docker-compose.yml` - 后端专用配置
- [x] 创建 `backend/Dockerfile` - 后端容器化配置

## 当前数据库配置

### 环境变量 (.env)
```env
DB_TYPE=mysql
DB_HOST=localhost
DB_PORT=3306
DB_USERNAME=root
DB_PASSWORD=
DB_DATABASE=family_finance
```

### 数据库初始化
项目包含 `backend/init-database.sql` 文件，用于初始化MariaDB数据库结构。

## 部署方式

### 开发环境
1. 确保MariaDB/MySQL服务运行在localhost:3306
2. 执行数据库初始化脚本
3. 启动后端服务：`cd backend && npm run start:dev`

### Docker部署
```bash
# 使用根目录docker-compose（包含前后端）
docker-compose up -d

# 或仅部署后端和数据库
cd backend
docker-compose up -d
```

## 数据库结构
项目使用以下表结构：
- `users` - 用户表
- `transactions` - 交易记录表

## 注意事项

1. **生产环境安全**：请在生产环境中修改默认密码和JWT密钥
2. **数据备份**：定期备份MariaDB数据库
3. **性能优化**：可根据数据量调整数据库配置参数

迁移已完成，项目现在完全支持MariaDB/MySQL数据库。